!function(t,n){"object"==typeof exports&&"object"==typeof module?module.exports=n():"function"==typeof define&&define.amd?define([],n):"object"==typeof exports?exports["client-logger"]=n():t["client-logger"]=n()}(window,(function(){return function(t){var n={};function e(r){if(n[r])return n[r].exports;var o=n[r]={i:r,l:!1,exports:{}};return t[r].call(o.exports,o,o.exports,e),o.l=!0,o.exports}return e.m=t,e.c=n,e.d=function(t,n,r){e.o(t,n)||Object.defineProperty(t,n,{enumerable:!0,get:r})},e.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},e.t=function(t,n){if(1&n&&(t=e(t)),8&n)return t;if(4&n&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(e.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&n&&"string"!=typeof t)for(var o in t)e.d(r,o,function(n){return t[n]}.bind(null,o));return r},e.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(n,"a",n),n},e.o=function(t,n){return Object.prototype.hasOwnProperty.call(t,n)},e.p="",e(e.s=0)}([function(t,n,e){"use strict";function r(){var t=this;this.list=[],this.add=function(n){10===t.list.length&&(t.list=t.list.slice(1)),t.list.push(n)}}function o(t){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}e.r(n);var i=function(t,n){var e={};for(var r in t)e[r]=t[r];for(var o in n)e[o]=n[o];return e},u=function(t){var n={};for(var e in t){var r=t[e];n[e]="function"==typeof r?r():r}return n},s=function(t,n){for(var e in t)Object.prototype.hasOwnProperty.call(t,e)&&n(e)},c=["string","number","boolean","null","undefined"];var a=function(t){return Object.keys(t).map((function(n){return t[n]}))};n.default={Logger:function t(n){var e=arguments,a=n.publisher,f=n.tags,l=void 0===f?{}:f,d=n.currentIsoDate,p=void 0===d?function(){return(new Date).toISOString()}:d,h=n.maxObjectDepth,v=void 0===h?3:h,y=n.maxArrayLength,g=void 0===y?10:y,m=n.windowConsole,b=void 0===m?window.console:m,w=n.localStorage,j=void 0===w?window.localStorage:w,O=n.liveLogsKey,S=void 0===O?"sm.live_logs":O,x=n.liveLogsEnabled,T=void 0!==x&&x,k=new r,P=function(t){return a.addToBucket("logs",t)},E=function(){return b&&(T||"1"===j[S])},L=function(t,n){for(var e=[],r=0;r<t.length;r++){if(r===g){e.push("-pruned-");break}e.push(A(t[r],n+1))}return e},I=function(t,n){if(v===n)return"-pruned-";var e={};return s(t,(function(r){e[r]=A(t[r],n+1)})),e},_=function(t){return{message:t.message,stack:t.stack}},A=function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return-1!==c.indexOf(o(t))?t:"function"==typeof t?"<Function>":t instanceof Error?_(t):Array.isArray(t)?L(t,n):I(t,n)},B=function(t){return function(){if(E()){var n=b[t]||b.log;n.apply(n,arguments)}var e=Array.prototype.slice.call(arguments).map((function(t){return A(t,0)})).filter((function(t){return void 0!==t})),r=u(l);r=i(r,{level:t,attributes:e,timestamp:p()}),"error"===t?r=i(r,{breadcrumbs:k.list}):k.add(r),P(r)}},M=function(t){return t.filter((function(t){return t instanceof Error})).length>0};this.debug=B("debug"),this.log=B("info"),this.info=B("info"),this.warn=B("warn"),this.error=function(){var t=Array.prototype.slice.call(arguments);return"string"!=typeof t[0]||M(t)||(t[0]=new Error(t[0])),B("error").apply(null,t)},this.withTags=function(n){return new t(i(e[0],{tags:i(l,n)}))},this.enableLiveLogs=function(){return j[S]="1"}},Publisher:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.publishInterval,e=void 0===n?3e3:n,r=t.maximumBatchSize,o=void 0===r?50:r,i=t.maximumBufferSize,u=void 0===i?1e3:i,s=t.maximumConsecutiveRetries,c=void 0===s?10:s,f=t.transports,l=void 0===f?[]:f,d=function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},e=n.position;void 0===e&&(e=l.length),l.splice(e,0,t)},p={},h={},v=function t(n){var e=n.transports,r=n.payload;return 0===e.length?Promise.reject():e[0].process({payload:r}).catch((function(){return t({payload:r,transports:e.slice(1)})}))},y=function(t){return 0===Object.keys(t).length||a(t).every((function(t){return 0===t.length}))},g=function(){var t={};return Object.keys(p).forEach((function(n){t[n]=p[n].splice(0,o)})),y(t)?Promise.resolve():v({transports:l,payload:t}).then((function(){return Object.keys(h).forEach((function(t){return h[t]=0})),Promise.resolve()})).catch((function(){return Object.keys(t).forEach((function(n){h[n]++,h[n]<c?p[n]=t[n].concat(p[n]):h[n]=0})),Promise.reject()}))},m=!1,b=null,w=!1,j=function(){if(m)throw new Error("Publisher is already started");m=!0,b=setInterval((function(){w||(w=!0,g().then((function(){return w=!1}),(function(){return w=!1})))}),e),window.addEventListener("unload",g)},O=function(){m=!1,clearInterval(b)},S=function(t,n){p[t]||(h[t]||(h[t]=0),p[t]=[]),p[t].push(n),p[t].splice(u)};return{start:j,stop:O,addToBucket:S,flush:g,buckets:p,addTransport:d,transports:l}},StatsRecorder:function t(n){var e=n.publisher,r=n.globalTags,o=void 0===r?[]:r,i=function(t){return e.addToBucket("stats",t)},u=function(t,n,e,r){return r||(r=[]),{stat:t,params:[n,e,o.concat(r)]}};this.increment=function(t,n,e){isNaN(parseInt(n))&&(e=n,n=1),i(u("increment",t,n,e))},this.decrement=function(t,n,e){isNaN(parseInt(n))&&(e=n,n=1),i(u("decrement",t,n,e))},this.gauge=function(t,n,e){i(u("gauge",t,n,e))},this.histogram=function(t,n,e){i(u("histogram",t,n,e))},this.timing=function(t,n,e){i(u("timing",t,n,e))},this.set=function(t,n,e){i(u("set",t,n,e))},this.withTags=function(n){return new t({publisher:e,globalTags:o.concat(n)})}},transports:{CustomTransport:function(t){if(!t)throw new Error("processFn must be specificed when using CustomTransport");this.process=t},HttpTransport:function(t){var n=t.url,e=t.method,r=t.headers,o=t.encode;if(!n)throw new Error("url must be specificed when using HttpTransport");e||(e="POST"),r||(r={}),o||(o=function(t){return JSON.stringify(t)}),this.process=window.fetch?function(t){var i=t.payload;return window.fetch(n,{method:e,headers:r,keepalive:!0,body:o(i)})}:function(t){var i=t.payload;return new Promise((function(t,u){var s=new XMLHttpRequest;s.open(e,n),Object.keys(r).forEach((function(t){s.setRequestHeader(t,r[t])})),s.onload=function(){s.status<200||status>=300?u():t()},s.onerror=function(){return u()},s.send(o(i))}))}}}}}])}));