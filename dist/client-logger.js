!function(t,n){"object"==typeof exports&&"object"==typeof module?module.exports=n():"function"==typeof define&&define.amd?define([],n):"object"==typeof exports?exports["client-logger"]=n():t["client-logger"]=n()}(window,function(){return function(t){var n={};function e(r){if(n[r])return n[r].exports;var o=n[r]={i:r,l:!1,exports:{}};return t[r].call(o.exports,o,o.exports,e),o.l=!0,o.exports}return e.m=t,e.c=n,e.d=function(t,n,r){e.o(t,n)||Object.defineProperty(t,n,{enumerable:!0,get:r})},e.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},e.t=function(t,n){if(1&n&&(t=e(t)),8&n)return t;if(4&n&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(e.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&n&&"string"!=typeof t)for(var o in t)e.d(r,o,function(n){return t[n]}.bind(null,o));return r},e.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(n,"a",n),n},e.o=function(t,n){return Object.prototype.hasOwnProperty.call(t,n)},e.p="",e(e.s=0)}([function(t,n,e){"use strict";function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}e.r(n);var o=function(t,n){var e={};for(var r in t)e[r]=t[r];for(var o in n)e[o]=n[o];return e},i=function(t){return Object.keys(t).reduce(function(n,e){var r=t[e];return n[e]="function"==typeof r?r():r,n},{})},u=function(t,n){for(var e in t)Object.prototype.hasOwnProperty.call(t,e)&&n(e)},a=["string","number","boolean","null","undefined"];var c=function(t){return Object.keys(t).map(function(n){return t[n]})};n.default={Logger:function t(n){var e=arguments,c=n.publisher,s=n.tags,f=void 0===s?{}:s,l=n.currentIsoDate,p=void 0===l?function(){return(new Date).toISOString()}:l,d=n.maxObjectDepth,y=void 0===d?3:d,h=n.maxArrayLength,v=void 0===h?10:h,g=n.windowConsole,b=void 0===g?window.console:g,m=n.localStorage,w=void 0===m?window.localStorage:m,O=n.liveLogsKey,S=void 0===O?"sm.live_logs":O,j=n.liveLogsEnabled,T=void 0!==j&&j,k=function(t,n){for(var e=[],r=0;r<t.length;r++){if(r===v){e.push("-pruned-");break}e.push(E(t[r],n+1))}return e},x=function(t,n){if(y===n)return"-pruned-";var e={};return u(t,function(r){e[r]=E(t[r],n+1)}),e},E=function(t){var n,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return-1!==a.indexOf(r(t))?t:"function"==typeof t?"<Function>":t instanceof Error?{message:(n=t).message,stack:n.stack}:Array.isArray(t)?k(t,e):x(t,e)},P=function(t){return function(){if(b&&(T||"1"===w[S])){var n=b[t]||b.log;n.apply(n,arguments)}var e,r=Array.prototype.slice.call(arguments).map(function(t){return E(t,0)}).filter(function(t){return void 0!==t}),u=i(f);u=o(u,{level:t,attributes:r,timestamp:p()}),e=u,c.addToBucket("logs",e)}};this.debug=P("debug"),this.log=P("info"),this.info=P("info"),this.warn=P("warn"),this.error=function(){var t=Array.prototype.slice.call(arguments);return"string"!=typeof t[0]||function(t){return t.filter(function(t){return t instanceof Error}).length>0}(t)||(t[0]=new Error(t[0])),P("error").apply(null,t)},this.withTags=function(n){return new t(o(e[0],{tags:o(f,n)}))},this.enableLiveLogs=function(){return w[S]="1"}},Publisher:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.publishInterval,e=void 0===n?3e3:n,r=t.maximumBatchSize,o=void 0===r?50:r,i=t.maximumBufferSize,u=void 0===i?1e3:i,a=t.transports,s=void 0===a?[]:a,f={},l=function(){var t={};Object.keys(f).forEach(function(n){t[n]=f[n].splice(0,o)}),function(t){return 0===Object.keys(t).length||c(t).every(function(t){return 0===t.length})}(t)||function t(n){var e=n.transports,r=n.payload,o=n.onFailure;if(0===e.length)return o();e[0].process({payload:r,onFailure:function(){return t({payload:r,transports:e.slice(1),onFailure:o})}})}({transports:s,payload:t,onFailure:function(){Object.keys(t).forEach(function(n){f[n]=t[n].concat(f[n])})}})},p=!1;return{start:function(){if(p)throw new Error("Publisher is already started");p=!0,setInterval(l,e),window.addEventListener("unload",l)},addToBucket:function(t,n){f[t]||(f[t]=[]),f[t].push(n),f[t].splice(u)},flush:l,buckets:f,addTransport:function(t){var n=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).position;void 0===n&&(n=s.length),s.splice(n,0,t)},transports:s}},StatsRecorder:function t(n){var e=n.publisher,r=n.globalTags,o=void 0===r?[]:r,i=function(t){return e.addToBucket("stats",t)},u=function(t,n,e,r){return r||(r=[]),{stat:t,params:[n,e,o.concat(r)]}};this.increment=function(t,n,e){i(u("increment",t,n||1,e))},this.decrement=function(t,n,e){i(u("decrement",t,n||1,e))},this.gauge=function(t,n,e){i(u("gauge",t,n,e))},this.histogram=function(t,n,e){i(u("histogram",t,n,e))},this.timing=function(t,n,e){i(u("timing",t,n,e))},this.set=function(t,n,e){i(u("set",t,n,e))},this.withTags=function(n){return new t({publisher:e,globalTags:o.concat(n)})}},transports:{CustomTransport:function(t){if(!t)throw new Error("processFn must be specificed when using CustomTransport");this.process=t},HttpTransport:function(t){var n=t.url,e=t.method,r=t.headers,o=t.encode;if(!n)throw new Error("url must be specificed when using HttpTransport");e||(e="POST"),r||(r={}),o||(o=function(t){return JSON.stringify(t)}),this.process=window.fetch?function(t){var i=t.payload,u=t.onFailure;window.fetch(n,{method:e,headers:r,keepalive:!0,body:o(i)}).catch(function(){return u()})}:function(t){var i=t.payload,u=t.onFailure,a=new XMLHttpRequest;a.open(e,n),Object.keys(r).forEach(function(t){a.setRequestHeader(t,r[t])}),a.onload=function(){(a.status<200||status>=300)&&u()},a.onerror=function(){return u()},a.send(o(i))}}}}}])});